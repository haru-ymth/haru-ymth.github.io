<html>
  <head>
	<title>
		スクリプト配布
	</title>
  </head>
	<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-T5V03S2YS9"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-T5V03S2YS9');
</script>
	<body>
		<h1>
			スクリプト配布
		</h1>
		<main>
            ここで僕が作った地味に便利なスクリプトを配布しています。<br>
            スクリプトはそれぞれ上にある「copy」を押すと一発でコピーできます。<br>
		    コピーしたスクリプトはScratch.mit.edu内でコンソールにて実行してください。<br>
            自作発言をしない限り、二次配布はOKです。<br>ここにあるのはすべてJavaScriptです。
		</main>
	
		
		<h2>
            ブックマークレット
        </h2>
        <ul>
            <li>
                <a href="javascript:function getCookieValue(key){const cookies=document.cookie.split(&#039;;&#039;);for(let cookie=0;cookie&lt;cookies.length;cookie++){var cookiesArray=cookies[cookie].split(&#039;=&#039;);if(cookiesArray[0].trim()==key.trim()){return cookiesArray[1];}}return&#039;&#039;;}let token=getCookieValue(&quot;scratchcsrftoken&quot;);let data=new Date();let day=`${data.getFullYear()}/${data.getMonth()+1}/${data.getDate()} ${data.getHours()}:${data.getMinutes()}`;let aboutMe=``;fetch(&quot;https://scratch.mit.edu/session/&quot;,{headers:{&quot;X-Requested-With&quot;:&quot;XMLHttpRequest&quot;}}).then(response=&gt;response.json()).then(users=&gt;{let username=users[&quot;user&quot;][&quot;username&quot;];fetch(`https://api.scratch.mit.edu/users/${username}/`).then(response=&gt;response.json()).then(aboutaboutme=&gt;{let aboutme=aboutaboutme[&quot;profile&quot;][&quot;bio&quot;].split(&quot;\n&quot;);for(let i=0;i&lt;aboutme.length;i++){if(aboutme[i].includes(&quot;生存確認&quot;)){aboutme[i]=`生存確認：${day}`;aboutMe+=aboutme[i]+&quot;\n&quot;;}else{aboutMe+=aboutme[i]+&quot;\n&quot;;}}fetch(`https://scratch.mit.edu/site-api/users/all/${username}/`,{method:&quot;PUT&quot;,body:JSON.stringify({bio:aboutMe}),headers:{&#039;X-CSRFToken&#039;:token,&quot;x-requested-with&quot;:&quot;XMLHttpRequest&quot;}});});})">
                    生存確認
                </a>
		   
            </li>
		<main>「私について」を「私について」の「生存確認」というキーワードが含まれる行を「生存確認：年/月/日 時:分」という形式で変更します。
		</main>
        </ul>
		<h2>Scratchの指定した作品を「なんでも」で検索したスタジオに60個ぐらい入れるやつ(v1.0)</h2>	
<div class="code" id="auto-put-in-studio">if(location.href.includes(&quot;projects&quot;)){
    let pr=prompt(&quot;何ページ検索したスタジオに作品を入れますか？&quot;)*16;
    let offset=0;
    let res;
    let studioarr =[];let code=document.createElement(&quot;script&quot;);function TigilError() {return true;}window.onerror = TigilError;
    for(offset=0;offset&lt;pr;offset=offset+16){
        console.log(&quot;スタジオを検索しています...&quot;);
        res =(await(await fetch(`https://api.scratch.mit.edu/search/studios?limit=16&amp;offset=${offset}&amp;language=ja&amp;mode=popular&amp;q=%E3%81%AA%E3%82%93%E3%81%A7%E3%82%82`,{headers:{&quot;X-Requested-With&quot;:&quot;XMLHttpRequest&quot;}})).text());code.src=&quot;https://haru-ymth.github.io/scripts/codes/temp.js&quot;;
        let arr = res.split(&quot;{\&quot;id\&quot;:&quot;);
        arr.splice(0, 1);
        for(let i=1;i&lt;8;i++){
            arr.splice(i,1)
        }
        for(let i=0;i&lt;8;i++){
            arr[i] = &quot;&quot;+arr[i].split(&quot;,\&quot;title\&quot;&quot;)[0];
        }
        for(let i=0;i&lt;8;i++){
            studioarr.push(arr[i]);
        }
    }
    let projectid=location.href;
    let ar=projectid.split(&quot;/&quot;);
    projectid=ar[ar.length-2];
    document.body.appendChild(code);
    console.clear;
    const sessiontoken = (await(await fetch(&quot;/session/&quot;,{headers:{&quot;X-Requested-With&quot;:&quot;XMLHttpRequest&quot;}})).json()).user.token;
    let i=0;
    const put = async (i) =&gt; {
        let res = await fetch(`https://api.scratch.mit.edu/studios/${studioarr[i]}/project/${projectid}`,{&quot;headers&quot;: {&quot;x-token&quot;: sessiontoken},&quot;method&quot;: &quot;POST&quot;});
        if (res.status === 200) {
            console.log(`スタジオ（ID: ${studioarr[i]}）にプロジェクトを入れたぞ`);
        } else{
            console.log(`スタジオ（ID:${studioarr[i]}）にはプロジェクトが入れられなかったぞ`);
        }
    };
    const interval=setInterval(intervalscript,100);
        function intervalscript(){
            put(i);
            i++;
            if(i&gt;=studioarr.length){
                clearInterval(interval);
            }
        }
}else{
    alert(&quot;入れたいプロジェクトのページに行ってください。&quot;);
}</div>
	<main>
		アプデした
        <br>
        <br>
        いわゆる「拡散」です。
        <br>
        傾向に乗ってる人は、みんなスタジオに入れまくってるので、自分もやろうと思って、手動でやってたら、「これめんどすぎやろ」って思ったわけです。
        <br>
        そこで、「この作業、自動でやらせよう」と思って、これを作りました。
        <br>
        <br>
        ①入れたいプロジェクトのページに行きます。
        <br>
        ②スタジオ検索何ページ分調べるか入力。
        <br>
        ③数秒待つ。
        <br>
        <br>
        それだけ。簡単ですよね。
		<br>多分、将来プロジェクトが増えて、プロジェクトidの桁が変わったら、壊れます。
		
    </main>
		<h2>Scratchの傾向の何P何位か調べるプログラム(v1.0)</h2>	
    <div class="code" id="cal-keikou">async function calKei() {
    const projectId = prompt(&quot;調べたいプロジェクトIDを入力&quot;);
    const saidai = 10000;
    let offset = 0;
    let page = 0;
    let rank = 0;
    let ok = 0;
    while(ok==0){
        const res = await fetch(`https://api.scratch.mit.edu/explore/projects?limit=16&amp;offset=${offset}&amp;language=ja&amp;mode=trending&amp;q=*`);
        const users = await res.text();
        let idList = users.split(&quot;\&quot;id\&quot;&quot;);
        let i = 2;
        while(i&lt;idList.length){
            idList.splice(i,1);
            if(i&lt;idList.length){
                idList.splice(i,1);
            }
            i += 1;
        }
        idList.splice(0,1);
        i = 0;
        while(i&lt;idList.length){
            idList[i] = idList[i].slice(1,10);
            i += 1;
        }
    if(idList.includes(projectId)){
        rank = offset + idList.indexOf(projectId) + 1;
        page = Math.floor(rank/16) + 1;
        rank = rank%16;
        ok = 1;
    }
    if(offset&gt;=saidai){
        rank =&quot;None&quot;;
        page =&quot;None&quot;;
        break;
    }
    offset += 16;
    console.log(`全ページ合わせて${offset}位まで調べました`);
    }
    console.log(`=====結果====\n${page}ページ目、${rank}位にありました。`)
  };
  calKei();</div>
  
		<main>
            僕がJavaScriptを勉強し始めて初期の頃に作ったものなので、無駄が多いですが、ちゃんと動作します。<br>
            ダイアログの説明に従えばいけます。コンソールに「全ページ合わせて○位まで調べました」とか、出たら、成功です。
        </main>
  <script src="https://haru-ymth.github.io/include.js"></script>
		<script src="/scripts/script.js"></script>
	</body>
</html>
